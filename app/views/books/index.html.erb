<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <!-- Page Title -->
  <div class="mb-12">
    <h1 class="text-5xl md:text-6xl font-bold text-black mb-4">
      üìö Reading List
    </h1>
    <p class="text-xl text-black font-semibold">
      Books that shaped my thinking on development, fitness, and life. Reviews, notes, and recommendations.
    </p>
  </div>

  <!-- Category Filter -->
  <% if @categories.any? %>
    <div class="mb-12">
      <div class="flex flex-wrap gap-3">
        <%= link_to "All Books", books_path, class: "px-4 py-2 font-bold transition-colors border-2 border-black #{@selected_category.nil? ? 'bg-black text-eggwhite' : 'bg-eggwhite text-black hover:bg-black hover:text-eggwhite'}" %>

        <% @categories.each do |category| %>
          <%= link_to category.titleize, books_path(category: category), class: "px-4 py-2 font-bold transition-colors border-2 border-black #{@selected_category == category ? 'bg-black text-eggwhite' : 'bg-eggwhite text-black hover:bg-black hover:text-eggwhite'}" %>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- Featured Books -->
  <% if @featured_books.any? && @selected_category.nil? %>
    <section class="mb-16">
      <h2 class="text-3xl font-bold text-black mb-8 border-b-2 border-black pb-3">‚≠ê Featured Books</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <% @featured_books.each do |book| %>
          <div class="bg-yellow-200 border-2 border-black p-6 hover:bg-yellow-300">
            <div class="mb-4">
              <span class="inline-block px-2 py-1 bg-black text-eggwhite text-xs font-bold uppercase border-2 border-black mb-3">
                Featured
              </span>

              <h3 class="text-xl font-bold text-black mb-2">
                <%= book.title %>
              </h3>

              <p class="text-black text-sm mb-3 font-semibold">by <%= book.author %></p>

              <% if book.rating %>
                <div class="flex items-center mb-3">
                  <span class="text-yellow-600 text-sm font-bold">
                    <%= book.star_rating %>
                  </span>
                </div>
              <% end %>
            </div>

            <% if book.has_review? %>
              <p class="text-black text-sm mb-4"><%= book.excerpt(150) %></p>
            <% end %>

            <div class="flex items-center justify-between pt-4 border-t-2 border-black">
              <% if book.category.present? %>
                <span class="px-2 py-1 bg-black text-eggwhite text-xs font-bold border-2 border-black">
                  <%= book.category.titleize %>
                </span>
              <% end %>

              <% if book.affiliate_link.present? %>
                <a
                  href="<%= book.affiliate_link %>"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center text-black hover:underline font-bold text-sm border-2 border-black px-3 py-1 bg-eggwhite hover:bg-black hover:text-eggwhite"
                >
                  Buy Now ‚Üí
                </a>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </section>
  <% end %>

  <!-- All Books -->
  <section>
    <h2 class="text-3xl font-bold text-black mb-8 border-b-2 border-black pb-3">
      <% if @selected_category.present? %>
        <%= @selected_category.titleize %> Books
      <% else %>
        All Books
      <% end %>
    </h2>

    <% if @books.any? %>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <% @books.each do |book| %>
          <div class="bg-eggwhite border-2 border-black p-6 hover:bg-eggwhite-dark">
            <!-- Book Header -->
            <div class="flex items-start justify-between mb-4">
              <div class="flex-1">
                <h3 class="text-xl font-bold text-black mb-2">
                  <%= book.title %>
                </h3>

                <p class="text-black text-sm mb-3 font-semibold">by <%= book.author %></p>

                <div class="flex flex-wrap items-center gap-2 mb-3">
                  <% if book.rating %>
                    <span class="text-yellow-600 text-sm font-bold">
                      <%= book.star_rating %>
                    </span>
                  <% end %>

                  <% if book.category.present? %>
                    <span class="px-2 py-1 bg-black text-eggwhite text-xs font-bold border-2 border-black">
                      <%= book.category.titleize %>
                    </span>
                  <% end %>

                  <% if book.read_date %>
                    <span class="text-black text-xs font-semibold">
                      Read <%= book.read_date.strftime("%b %Y") %>
                    </span>
                  <% end %>
                </div>
              </div>
            </div>

            <!-- Review -->
            <% if book.has_review? %>
              <div class="mb-4">
                <h4 class="text-sm font-bold text-black mb-2">
                  üìù Review
                </h4>

                <div class="text-black text-sm leading-relaxed prose max-w-none">
                  <%= book.review %>
                </div>
              </div>
            <% end %>

            <!-- Notes -->
            <% if book.has_notes? %>
              <div class="mb-4 p-4 bg-eggwhite-dark border-2 border-black">
                <h4 class="text-sm font-bold text-black mb-2">
                  üí° Notes
                </h4>

                <div class="text-black text-sm leading-relaxed prose max-w-none">
                  <%= book.notes %>
                </div>
              </div>
            <% end %>

            <!-- Actions -->
            <div class="flex items-center justify-between pt-4 border-t-2 border-black">
              <div class="text-xs text-black font-semibold">
                <% if book.isbn.present? %>
                  <span>ISBN: <%= book.isbn %></span>
                <% end %>
              </div>

              <% if book.affiliate_link.present? %>
                <a
                  href="<%= book.affiliate_link %>"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="inline-flex items-center text-black hover:underline font-bold text-sm border-2 border-black px-3 py-1 bg-eggwhite hover:bg-black hover:text-eggwhite"
                >
                  Buy on Amazon ‚Üí
                </a>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="bg-eggwhite border-2 border-black p-12 text-center">
        <p class="text-black text-lg font-bold">No books found in this category.</p>
        <%= link_to "View All Books", books_path, class: "inline-block mt-4 text-black hover:underline font-bold border-2 border-black px-4 py-2 bg-eggwhite hover:bg-black hover:text-eggwhite" %>
      </div>
    <% end %>
  </section>

  <!-- Top Rated Books Sidebar (if not filtering) -->
  <% if @selected_category.nil? && @top_rated_books.any? %>
    <section class="mt-16">
      <h2 class="text-3xl font-bold text-black mb-8 border-b-2 border-black pb-3">üèÜ Top Rated</h2>

      <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
        <% @top_rated_books.each do |book| %>
          <div class="bg-eggwhite border-2 border-black p-4 hover:bg-yellow-200">
            <h4 class="text-sm font-bold text-black mb-1 line-clamp-2">
              <%= book.title %>
            </h4>

            <p class="text-xs text-black mb-2 font-semibold"><%= book.author %></p>

            <% if book.rating %>
              <span class="text-yellow-600 text-xs font-bold">
                <%= book.star_rating %>
              </span>
            <% end %>
          </div>
        <% end %>
      </div>
    </section>
  <% end %>

  <!-- Affiliate Disclaimer -->
  <div class="mt-16 p-6 bg-eggwhite-dark border-2 border-black">
    <p class="text-black text-sm">
      <span class="font-bold text-black">Affiliate Disclosure:</span>
      Some of the links on this page are affiliate links. If you purchase through these links, I may earn a small commission at no extra cost to you. I only recommend books I've personally read and found valuable.
    </p>
  </div>
</div>
